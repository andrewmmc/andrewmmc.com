---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';
import FormattedDate from '../../components/FormattedDate.astro';

const posts = (await getCollection('blog'))
  .filter((post) => post.data.pubDate != null)
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());
---

<BaseLayout title="Blog">
  <section>
    <h2 class="text-base leading-tight font-medium text-gray-400 uppercase mb-4">All posts</h2>
    <ul class="list-none">
      {
        posts.map((post) => (
          <li class="mb-3">
            <div class="flex flex-col text-gray-600 text-sm">
              <div class="text-gray-600 text-sm mb-1">
                <FormattedDate date={post.data.pubDate} />
              </div>
              <h3 class="text-lg leading-tight font-medium text-gray-800 mb-2">
                <a
                  href={`/blog/${post.id}/`}
                  class="post-link text-gray-800 transition-all duration-150 ease-out hover:text-gray-800 hover:no-underline"
                >
                  {post.data.title}
                </a>
              </h3>
            </div>
          </li>
        ))
      }
    </ul>
  </section>
</BaseLayout>

<style>
  .post-link {
    display: inline-block;
    padding: 0.25rem 0.5rem;
    margin: -0.25rem -0.5rem;
    border-radius: 0.25rem;
  }

  .post-link:focus {
    outline: none;
    box-shadow: none;
    background-color: color-mix(in oklab, var(--color-primary-50) 50%, transparent);
  }
</style>
