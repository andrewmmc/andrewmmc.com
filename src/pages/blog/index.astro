---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';

const posts = (await getCollection('blog'))
  .filter((post) => post.data.pubDate != null)
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());

function formatDate(date: Date): string {
  return date.toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' });
}
---

<BaseLayout title="Blog">
  <section>
    <p class="text-xs font-medium text-stone-400 uppercase tracking-widest mb-6">All posts</p>
    <ul>
      {
        posts.map((post) => (
          <li class="border-b border-stone-100 last:border-b-0">
            <a
              href={`/blog/${post.id}/`}
              class="flex items-baseline justify-between gap-6 py-4 group focus-visible:outline-none focus-visible:bg-amber-50 rounded-sm -mx-2 px-2"
            >
              <span class="text-stone-800 font-medium leading-snug group-hover:text-stone-950 transition-colors duration-150">
                {post.data.title}
              </span>
              <span class="text-stone-400 text-sm whitespace-nowrap flex-shrink-0 tabular-nums">
                {formatDate(post.data.pubDate)}
              </span>
            </a>
          </li>
        ))
      }
    </ul>
  </section>
</BaseLayout>
